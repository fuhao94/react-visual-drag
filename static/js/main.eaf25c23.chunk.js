(this["webpackJsonpvisual-drag"]=this["webpackJsonpvisual-drag"]||[]).push([[0],{180:function(e,t,n){},188:function(e,t,n){},218:function(e,t,n){},223:function(e,t,n){},224:function(e,t,n){},225:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/cat.2fdfd017.jpeg"},297:function(e,t,n){},302:function(e,t,n){"use strict";n.r(t);n(218);var a=n(18),c=n(208),o=n.n(c),r=n(0),i=n.n(r),s=n(29),l=n.n(s),u=(n(223),n(62)),b=n(33),p=(n(224),n(205)),d=n(308),j=n(7),h=n(322),f={rotate:0,opacity:1,top:0,left:0},m=function(){var e=[{name:"r-input",label:"\u6587\u5b57",props:{placeholder:"\u8bf7\u8f93\u5165"},style:{width:200,height:32}},{name:"r-button",label:"\u6309\u94ae",props:{},style:{width:100,height:32,borderWidth:1,borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:""}},{name:"r-img",label:"\u56fe\u7247",props:{src:n(225).default},style:{width:192,height:120}}];return Object(h.a)(e,(function(e){return Object(j.a)(Object(j.a)({id:-1},e),{},{style:Object(j.a)(Object(j.a)({},e.style),f)})}))}(),O=n(45);function v(e){return e*Math.PI/180}function x(e){return Math.abs(Math.sin(v(e)))}function y(e){return Math.abs(Math.cos(v(e)))}var g=1;function C(){return g++}function S(e){return document.querySelector(e)}var w=function(e){return["width","height","top","left","rotate"].reduce((function(t,n){return"rotate"!==n?Object(j.a)(Object(j.a)({},t),{},Object(O.a)({},n,(e[n]||0)+"px")):Object(j.a)(Object(j.a)({},t),{},{transform:"rotate("+(e[n]||0)+"deg)"})}),{})};function N(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=["fontSize","width","height","top","left","borderWidth","letterSpacing","borderRadius","backgroundImage"];return Object.keys(e).reduce((function(a,c){return t.includes(c)||n.includes(c)&&(a[c]=e[c]+"px"),a}),{})}(e,["top","left","rotate"])}function D(e,t){var n=t.width,a=t.height,c=/t/.test(e),o=/b/.test(e),r=/l/.test(e),i=/r/.test(e),s=0,l=0;return 2===e.length?(s=r?0:n,l=c?0:a):((c||o)&&(s=n/2,l=c?0:a),(r||i)&&(s=r?0:n,l=Math.floor(a/2))),{marginLeft:"-4px",marginTop:"-4px",left:"".concat(s,"px"),top:"".concat(l,"px")}}function k(e){var t=Object(j.a)({},e),n=Number(t.width),a=Number(t.height),c=Number(t.left),o=Number(t.top),r=Number(t.rotate);if(0!==Number(t.rotate)){var i=n*y(r)+a*x(r),s=(n-i)/2;t.left=s+c,t.right=c+i;var l=a*y(r)+n*x(r),u=(l-a)/2;t.top=o-u,t.bottom=o+l,t.width=i,t.height=l}else t.bottom=o+a,t.right=c+n;return t}var E=n(326),I=n(327),M=n(328),P=n(116),L=n(51),R=n(87),X=n(6),Y={"r-button":Object(X.jsx)(E.a,{}),"r-input":Object(X.jsx)(I.a,{}),"r-img":Object(X.jsx)(M.a,{})};function z(e){return Y[e]}var T=function(){return Object(X.jsx)("div",{onDragStart:function(e){e.dataTransfer.setData("index",e.target.dataset.index)},children:Object(X.jsx)(P.a,{children:Object(h.a)(m,(function(e,t){var n=e.label,a=e.name;return Object(X.jsx)(L.a,{span:12,style:{marginBottom:12,textAlign:"center"},children:Object(X.jsx)(R.a,{icon:z(a),"data-index":t,draggable:!0,children:n})},n)}))})})},W=Object(r.createContext)({componentDispatch:function(){},curComponentIndex:-1,componentState:{componentData:[],isClickComponent:!1,preview:!1,snapshots:[],snapshotIndex:-1,curComponentId:-1,dragShiftStyle:{},canvasStyle:{}}}),A=Object(r.createContext)({menuDispatch:function(){},menuState:{visible:!1,position:{left:0,top:0}}}),U=(n(180),n(319)),B=n(325),H=n(306),V=(n(188),n(315)),F=n(324),G=n(304),J=n(212),K={redirect:function(e){e&&(window.location.href=e)},message:function(e){e&&J.b.info(e)}},q=[{key:"message",label:"\u6d88\u606f\u63d0\u9192",event:K.message,param:""},{key:"redirect",label:"\u8df3\u8f6c\u4e8b\u4ef6",event:K.redirect,param:""}],Q=n(321),Z=n(311),$=n(323),_=n(305),ee=n(313);function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit",n=arguments.length>2?arguments[2]:void 0,a=Object(j.a)(Object(j.a)({},e.props),{},{style:N(e.style)});switch(e.name){case"r-button":return Object(X.jsx)(R.a,Object(j.a)(Object(j.a)({},a),{},{children:e.label}));case"r-input":return"preview"===t?Object(X.jsx)("span",{children:e.label}):Object(X.jsx)(Z.a,Object(j.a)(Object(j.a)({},a),{},{onChange:function(e){return null===n||void 0===n?void 0:n(e.target.value)}}));case"r-img":return Object(X.jsx)("img",Object(j.a)(Object(j.a)({draggable:"false"},a),{},{alt:e.label}))}}var ne=["lt","t","rt","r","rb","b","lb","l"],ae=function(e){var t=e.index,n=e.prefixCls,a=e.originalComponent,c=e.onMove,o=e.onDestroyMove,i=Object(r.useContext)(W),s=i.componentState,l=i.curComponentIndex,u=i.componentDispatch,p=Object(r.useContext)(A).menuDispatch,d=s.curComponentId,f=s.dragShiftStyle,m=s.componentData,O=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current}(f),v=Object(r.useState)(a),x=Object(b.a)(v,2),y=x[0],g=x[1];y.id;var C=Object(r.useRef)(S("#editor")),N=Object($.a)((function(e){u({type:"setComponentStyle",payload:{style:e,index:t}})}),100),k=function(e){g(Object(j.a)(Object(j.a)({},y),{},{style:e})),N(e)},E=Object($.a)((function(e){u({type:"setComponentProps",payload:{index:l,config:{label:e}}})}),1e3);return Object(r.useEffect)((function(){if(y.id===d&&!Object(G.a)(f)&&!Object(_.a)(f,O)){var e=Object(ee.a)(y.style,f);k(e),u({type:"setCurComponentDragShift",payload:{}})}}),[f]),Object(r.useEffect)((function(){d===y.id&&!Object(G.a)(m)&&l>-1&&g(m[l]),Object(H.a)(C.current)&&(C.current=S("#editor"))}),[m]),Object(X.jsxs)("div",{id:"component-".concat(y.id),className:n,style:w(y.style),onClick:function(e){e.stopPropagation(),e.preventDefault(),p({type:"hide"})},onMouseDown:function(e){e.stopPropagation(),u({type:"setClick",payload:!0}),u({type:"setCurComponent",payload:{id:y.id}});var t=Object(j.a)({},y.style),n=e.clientY,a=e.clientX,r=Number(t.top),i=Number(t.left),s=function(o){var s=o.clientX,l=o.clientY;t.top=l-n+r,t.left=s-a+i,k(t),c(e,t)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",e),o()}))},children:[d===y.id&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)(Q.a,{className:"".concat(n,"-rotate"),onMouseDown:function(e){var t;u({type:"setClick",payload:!0}),e.preventDefault(),e.stopPropagation();var n=Object(j.a)({},y.style),a=e.clientY,c=e.clientX,o=n.rotate,r=null===(t=C.current)||void 0===t?void 0:t.getBoundingClientRect(),i=r.left+r.width/2,s=r.top+r.height/2,l=Math.atan2(a-s,c-i)/(Math.PI/180),b=function(e){var t=e.clientX,a=e.clientY,c=Math.atan2(a-s,t-i)/(Math.PI/180);n.rotate=Number(o)+c-l,k(n)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",e)}))}}),function(){var e=y.style.width,t=y.style.height;return Object(h.a)(ne,(function(a){return Object(X.jsx)("div",{className:"".concat(n,"-point"),style:D(a,{width:e,height:t}),onMouseDown:function(e){return function(e,t){t.stopPropagation(),t.preventDefault();var n=Object(j.a)({},y.style),a=Number(n.height),c=Number(n.width),o=Number(n.top),r=Number(n.left),i=t.clientX,s=t.clientY,l=function(t){var l=t.clientX,u=t.clientY-s,b=l-i,p=/t/.test(e),d=/b/.test(e),j=/l/.test(e),h=/r/.test(e),f=a+(p?-u:d?u:0),m=c+(j?-b:h?b:0);n.height=f>0?f:0,n.width=m>0?m:0,n.left=r+(j?b:0),n.top=o+(p?u:0),k(n)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",e)}))}(a,e)}},a)}))}()]}),te(y,"edit",E)]})};ae.defaultProps={prefixCls:"visual-drag-shape"};var ce=ae,oe=function(e){var t=e.prefixCls,n=e.component,a=Object(r.useContext)(W).componentState.componentData;return Object(X.jsx)("div",{className:t,style:w(n.style),onClick:function(){var e=Object(F.a)(a,["id",n.id]),t=(null===e||void 0===e?void 0:e.events)||[];Object(G.a)(t)||Object(B.a)(t,(function(e){K[e.key](e.value)}))},children:te(n,"preview")})};oe.defaultProps={prefixCls:"visual-drag-shape"};var re=oe,ie=function(e){var t=e.prefixCls,n=Object(r.useContext)(W),a=n.componentState,c=n.componentDispatch,o=a.componentData,i=a.preview,s=a.canvasStyle;return Object(X.jsx)(V.a,{visible:i,footer:null,closable:!1,width:s.width,style:Object(j.a)(Object(j.a)({},s),{},{top:50}),className:t,onCancel:function(){return c({type:"setPreview",payload:!1})},children:Object(h.a)(o,(function(e){return Object(X.jsx)(re,{component:e},e.id)}))})};ie.defaultProps={prefixCls:"visual-drag-preview"};var se=ie,le=function(e){return Object(X.jsx)("div",{style:e,className:"visual-drag-area"})},ue=function(e){var t=e.prefixCls,n=Object(r.useContext)(W).componentDispatch,a=Object(r.useContext)(A).menuState,c=a.visible,o=a.position;return Object(X.jsx)("div",{className:t,style:Object(j.a)({visibility:c?"visible":"hidden"},o),children:Object(X.jsxs)("ul",{onMouseUp:function(){return n({type:"setClick",payload:!0})},children:[Object(X.jsx)("li",{onClick:function(){return n({type:"copy"})},children:"\u590d\u5236"}),Object(X.jsx)("li",{onClick:function(){return n({type:"paste",payload:o})},children:"\u7c98\u8d34"}),Object(X.jsx)("li",{onClick:function(){return n({type:"destroyComponent"})},children:"\u5220\u9664"}),Object(X.jsx)("li",{onClick:function(){return n({type:"top"})},children:"\u7f6e\u9876"}),Object(X.jsx)("li",{onClick:function(){return n({type:"bottom"})},children:"\u7f6e\u5e95"}),Object(X.jsx)("li",{onClick:function(){return n({type:"up"})},children:"\u4e0a\u79fb"}),Object(X.jsx)("li",{onClick:function(){return n({type:"down"})},children:"\u4e0b\u79fb"})]})})};ue.defaultProps={prefixCls:"visual-drag-menu"};var be=ue,pe=function(){return Object(X.jsxs)("svg",{className:"grid",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:0,left:0,background:"#fff"},children:[Object(X.jsxs)("defs",{children:[Object(X.jsx)("pattern",{id:"smallGrid",width:"7.236328125",height:"7.236328125",patternUnits:"userSpaceOnUse",children:Object(X.jsx)("path",{d:"M 7.236328125 0 L 0 0 0 7.236328125",fill:"none",stroke:"rgba(207, 207, 207, 0.3)",strokeWidth:"1"})}),Object(X.jsxs)("pattern",{id:"grid",width:"36.181640625",height:"36.181640625",patternUnits:"userSpaceOnUse",children:[Object(X.jsx)("rect",{width:"36.181640625",height:"36.181640625",fill:"url(#smallGrid)"}),Object(X.jsx)("path",{d:"M 36.181640625 0 L 0 0 0 36.181640625",fill:"none",stroke:"rgba(186, 186, 186, 0.5)",strokeWidth:"1"})]})]}),Object(X.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})},de=n(316),je=["xt","xc","xb","yl","yc","yr"],he={xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1},fe={xt:{},xc:{},xb:{},yl:{},yc:{},yr:{}};function me(e,t){return Math.abs(e-t)<=3}var Oe=Object(r.forwardRef)((function(e,t){var n=e.prefixCls,a=Object(r.useContext)(W),c=a.componentState,o=a.componentDispatch,i=c.curComponentId,s=c.componentData,l=Object(r.useState)(he),u=Object(b.a)(l,2),p=u[0],d=u[1],f=Object(r.useState)(fe),m=Object(b.a)(f,2),v=m[0],x=m[1],y=function(e){var t=k(e),n=Number(t.width)/2,a=Number(t.height)/2,c=Number(t.width),r=Number(t.height),l=Number(t.left),u=Number(t.right),b=Number(t.top),p=Number(t.bottom);Object(B.a)(s,(function(e){if(e.id!==i){var t=k(e.style),s=Number(t.width),h=Number(t.height),f=Number(t.top),m=Number(t.bottom),y=Number(t.left),g=Number(t.right),C=s/2,S=h/2,w={top:[{line:"xt",isNearly:me(b,f),dragShift:f,lineShift:f},{isNearly:me(p,f),line:"xt",dragShift:f-r,lineShift:f},{isNearly:me(b+a,f+S),line:"xc",dragShift:f+S-a,lineShift:f+S},{isNearly:me(b,m),line:"xb",dragShift:m,lineShift:m},{isNearly:me(p,m),line:"xb",dragShift:m-r,lineShift:m}],left:[{isNearly:me(l,y),line:"yl",dragShift:y,lineShift:y},{isNearly:me(u,y),line:"yl",dragShift:y-c,lineShift:y},{isNearly:me(l+n,y+C),line:"yc",dragShift:y+C-n,lineShift:y+C},{isNearly:me(l,g),line:"yr",dragShift:g,lineShift:g},{isNearly:me(u,g),line:"yr",dragShift:g-c,lineShift:g}]},N=Object(j.a)({},v),D=Object(j.a)({},he);Object(B.a)(w,(function(e,t){Object(B.a)(e,(function(e){var n=e.line,a=e.isNearly,c=e.dragShift,r=e.lineShift;a&&(Object.assign(D,Object(O.a)({},n,a)),Object.assign(N,Object(O.a)({},n,a?Object(j.a)(Object(j.a)({},N[n]),{},Object(O.a)({},t,r)):{})),o({type:"setCurComponentDragShift",payload:Object(O.a)({},t,c)}))}))})),x(N),function(e){d(e)}(D)}}))};return Object(r.useImperativeHandle)(t,(function(){return{showLine:y,hideLine:function(){return d(he)}}})),Object(X.jsx)("div",{className:n,children:Object(h.a)(je,(function(e){return Object(X.jsx)("div",{className:"".concat(n,"-line ").concat(Object(de.a)(e,"x")?"".concat(n,"-xline"):"".concat(n,"-yline")),style:Object(j.a)({display:p[e]?"block":"none"},v[e])},e)}))})}));Oe.defaultProps={prefixCls:"visual-drag-mark"};var ve=Oe,xe=function(e){var t=e.prefixCls,n=Object(r.useContext)(W).componentState,a=Object(r.useContext)(A).menuDispatch,c=Object(r.useState)(!1),o=Object(b.a)(c,2),i=o[0],s=o[1],l=Object(r.useRef)(null),u=Object(r.useRef)(S("#editor")),p=Object(r.useRef)({editorX:0,editorY:0}),d=Object(r.useRef)({x:0,y:0}),j=Object(r.useState)({width:0,height:0}),f=Object(b.a)(j,2),m=f[0],O=f[1],v=Object(r.useRef)({width:0,height:0}),x=n.componentData,y=n.canvasStyle,g=function(e,t){var n;null===(n=l.current)||void 0===n||n.showLine(t)},C=function(){var e;null===(e=l.current)||void 0===e||e.hideLine()},w=function(){var e=function(){var e=d.current,t=e.x,n=e.y,a=v.current,c=a.width,o=a.height;return Object(U.a)(x,(function(e,a){var r=Number(a.style.left),i=Number(a.style.top),s=Number(a.style.width),l=Number(a.style.height);return t<=r&&n<=i&&r+s<=t+c&&i+l<=n+o&&e.push(a),e}),[])}();if(e.length<=1)s(!1);else{var t=p.current,n=t.editorX,a=t.editorY,c=1/0,o=1/0,r=-1/0,i=-1/0;Object(B.a)(e,(function(e){var t,s={},l=null===(t=S("#component-".concat(e.id)))||void 0===t?void 0:t.getBoundingClientRect();s.left=l.left-n,s.top=l.top-a,s.right=l.right-n,s.bottom=l.bottom-a,s.left<o&&(o=s.left),s.top<c&&(c=s.top),s.right>r&&(r=s.right),s.bottom>i&&(i=s.bottom)})),d.current={x:o,y:c},O({width:r-o,height:i-c})}};return Object(r.useEffect)((function(){Object(H.a)(u.current)&&(u.current=S("#editor"))}),[u.current]),Object(r.useEffect)((function(){v.current=m}),[m]),Object(X.jsxs)("div",{className:t,style:y,id:"editor",onContextMenu:function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target,n=e.nativeEvent.offsetY,c=e.nativeEvent.offsetX;t instanceof SVGElement;)t=t.parentNode;for(;!t.className.includes("visual-drag-editor");)c+=t.offsetLeft,n+=t.offsetTop,t=t.parentNode;a({type:"show"}),a({type:"setPosition",payload:{left:c,top:n}})},onMouseDown:function(e){var t;e.preventDefault(),s(!1),O({width:0,height:0});var n=null===(t=u.current)||void 0===t?void 0:t.getBoundingClientRect();p.current={editorX:n.x,editorY:n.y};var a=e.clientX,c=e.clientY;d.current={x:a-p.current.editorX,y:c-p.current.editorY},s(!0);var o=function(e){O({width:Math.abs(e.clientX-a),height:Math.abs(e.clientY-c)}),e.clientX<a&&(d.current.x=e.clientX-p.current.editorX),e.clientY<c&&(d.current.y=e.clientY-p.current.editorY)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",(function e(t){if(document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",e),t.clientX===a&&t.clientY===c)return s(!1),void O({width:0,height:0});w()}))},children:[Object(X.jsx)(pe,{}),Object(h.a)(x,(function(e,t){return Object(X.jsx)(ce,{index:t,originalComponent:e,onMove:g,onDestroyMove:C},e.id)})),Object(X.jsx)(be,{}),Object(X.jsx)(ve,{ref:l}),Object(X.jsx)(se,{}),i&&Object(X.jsx)(le,{top:d.current.y,left:d.current.x,width:m.width,height:m.height})]})};xe.defaultProps={prefixCls:"visual-drag-editor"};var ye=xe,ge=n(215),Ce=n(309),Se=n(186),we=n(312),Ne=n(318),De=n(314),ke=n(307),Ee=[{name:"label",label:"\u5185\u5bb9",componentName:"input",props:{}},{name:"opacity",label:"\u900f\u660e\u5ea6",componentName:"input",props:{}},{name:"width",label:"\u5bbd\u5ea6",componentName:"input",props:{}},{name:"height",label:"\u9ad8\u5ea6",componentName:"input",props:{}},{name:"fontSize",label:"\u5b57\u4f53\u5927\u5c0f",componentName:"input",props:{}},{name:"fontWeight",label:"\u5b57\u4f53\u7c97\u7ec6",componentName:"input",props:{}},{name:"lineHeight",label:"\u884c\u95f4\u8ddd",componentName:"input",props:{}},{name:"letterSpace",label:"\u5b57\u95f4\u8ddd",componentName:"input",props:{}},{name:"textAlign",label:"\u5bf9\u9f50\u65b9\u5f0f",componentName:"select",props:{options:[{label:"\u76f8\u5de6\u5bf9\u9f50",value:"left"},{label:"\u5c45\u4e2d\u5bf9\u9f50",value:"center"},{label:"\u76f8\u53f3\u5bf9\u9f50",value:"right"}]}}],Ie=n(317),Me=Se.a.TabPane,Pe=function(){var e=Object(r.useContext)(W),t=e.componentDispatch,n=e.componentState.curComponentId,a=Object(r.useState)(!1),c=Object(b.a)(a,2),o=c[0],i=c[1],s=Object(r.useState)(""),l=Object(b.a)(s,2),u=l[0],p=l[1],d=Object(r.useState)("message"),j=Object(b.a)(d,2),f=j[0],m=j[1];return Object(X.jsxs)("div",{children:[n>-1&&Object(X.jsx)(R.a,{type:"primary",onClick:function(){return i(!0)},children:"\u6dfb\u52a0\u4e8b\u4ef6"}),Object(X.jsxs)(Ie.a,{width:320,placement:"right",closable:!1,onClose:function(){return i(!1)},visible:o,children:[Object(X.jsx)(Se.a,{activeKey:f,onChange:function(e){return m(e)},children:Object(h.a)(q,(function(e){return Object(X.jsx)(Me,{tab:e.label,children:Object(X.jsx)(Z.a.TextArea,{value:u,onChange:function(e){return p(e.target.value)}})},e.key)}))}),Object(X.jsx)(R.a,{style:{marginTop:24},onClick:function(){t({type:"createEvents",payload:{key:f,value:u}}),p(""),J.b.success("\u4e8b\u4ef6\u6dfb\u52a0\u6210\u529f"),i(!1)},children:"\u786e\u8ba4"})]})]})},Le=["componentName","props"],Re=Ce.a.Item,Xe=Se.a.TabPane,Ye={opacity:void 0,width:void 0,height:void 0,fontSize:void 0,fontWeight:void 0,lineHeight:void 0,letterSpace:void 0,textAlign:void 0,label:void 0},ze=["label"],Te=Object(h.a)(Ee,(function(e){var t,n=e.componentName,a=e.props,c=Object(ge.a)(e,Le);switch(n){case"select":t=Object(X.jsx)(we.a,Object(j.a)({},a));break;default:t=Object(X.jsx)(Z.a,Object(j.a)({},a))}return Object(X.jsx)(Re,Object(j.a)(Object(j.a)({},c),{},{children:t}),c.name)})),We=function(e){var t=e.prefixCls,n=Object(r.useContext)(W),a=n.componentState,c=n.curComponentIndex,o=n.componentDispatch,i=a.curComponentId,s=a.componentData,l=a.snapshots,u=Object(r.useState)(Ye),p=Object(b.a)(u,2),d=p[0],f=p[1],m=Ce.a.useForm(),O=Object(b.a)(m,1)[0],v=Object(r.useRef)(!0),x=Object($.a)(O.resetFields,100),y=Object($.a)((function(e){o({type:"setComponentProps",payload:{index:c,config:e}})}),1e3);return Object(r.useEffect)((function(){var e=Ye;if(i>-1){var t=Object(F.a)(s,["id",i]);t&&(e=Object(j.a)(Object(j.a)({},t.style),{},{label:t.label}))}f(e)}),[i,s]),Object(r.useEffect)((function(){v.current?v.current=!1:x()}),[d]),Object(X.jsx)("div",{className:t,children:Object(X.jsxs)(Se.a,{defaultActiveKey:"property",children:[Object(X.jsx)(Xe,{forceRender:!0,tab:"\u5c5e\u6027",children:i>-1?Object(X.jsx)(Ce.a,{colon:!1,form:O,labelCol:{span:4},initialValues:d,onValuesChange:function(e,t){var n=t.label,a=Object(De.a)(t,ze);if(c>-1){var o=Object(j.a)(Object(j.a)({},s[c].style),a);y({label:n,style:o})}},children:Te}):"\u8bf7\u9009\u62e9\u7ec4\u4ef6"},"property"),Object(X.jsx)(Xe,{tab:"\u5feb\u7167",children:Object(h.a)(l,(function(e,t){var n=Object(ke.a)(Object(h.a)(e,"id"),",");return Object(X.jsxs)(Ne.a,{title:"\u7b2c ".concat(t+1," \u6b65"),children:["ids: ",n]},"".concat(t))}))},"animation"),Object(X.jsx)(Xe,{tab:"\u4e8b\u4ef6",children:Object(X.jsx)(Pe,{})},"event")]})})};We.defaultProps={prefixCls:"visual-drag-property"};var Ae=We,Ue=["destroyComponent","createEvents","removeEvents","bottom","copy","down","top","up"],Be=function(e,t,n){var a=Object(u.a)(e),c=[a[n],a[t]];return a[t]=c[0],a[n]=c[1],a};function He(e,t){var n=t.type,a=t.payload,c=-1;switch(Object(de.a)(Ue,n)&&(c=Object(p.a)(e.componentData,["id",e.curComponentId])),n){case"setComponentData":return Object(j.a)(Object(j.a)({},e),{},{componentData:a});case"setComponentProps":var o=a.config,r=a.index,i=Object(d.a)(e.componentData);return Object.assign(i[r],Object(j.a)({},o)),Object(j.a)(Object(j.a)({},e),{},{componentData:i});case"setComponentStyle":var s=a.style,l=a.index,b=Object(d.a)(e);return Object.assign(b.componentData[l],{style:s}),b;case"destroyComponent":var h=Object(u.a)(e.componentData),f=a;return void 0===f&&(f=c),f>-1&&h.splice(f,1),Object(j.a)(Object(j.a)({},e),{},{componentData:h});case"setCurComponent":return Object(j.a)(Object(j.a)({},e),{},{curComponentId:a.id});case"setCurComponentDragShift":return Object(j.a)(Object(j.a)({},e),{},{dragShiftStyle:a});case"setClick":return Object(j.a)(Object(j.a)({},e),{},{isClickComponent:a});case"undo":var m=Object(j.a)({},e);return m.componentData=m.snapshots[--m.snapshotIndex]||[],m;case"redo":if(e.snapshotIndex<e.snapshots.length-1){var O=e.snapshotIndex+1;return Object(j.a)(Object(j.a)({},e),{},{snapshotIndex:O,componentData:e.snapshots[O]})}return e;case"copy":return Object(j.a)(Object(j.a)({},e),{},{copyData:e.componentData[c]});case"paste":var v=Object(d.a)(e.copyData);return v?(Object.assign(v,{style:Object(j.a)(Object(j.a)({},v.style),a),id:C()}),Object(j.a)(Object(j.a)({},e),{},{componentData:[].concat(Object(u.a)(e.componentData),[v])})):(J.b.error("\u8bf7\u9009\u62e9\u7ec4\u4ef6"),e);case"top":var x=Object(u.a)(e.componentData);return x.length<2?e:Object(j.a)(Object(j.a)({},e),{},{componentData:Be(x,c,x.length-1)});case"bottom":var y=Object(u.a)(e.componentData);return y.length<2?e:Object(j.a)(Object(j.a)({},e),{},{componentData:Be(y,c,0)});case"up":var g=Object(u.a)(e.componentData);return g.length<2||c===g.length-1?e:Object(j.a)(Object(j.a)({},e),{},{componentData:Be(g,c,c+1)});case"down":var S=Object(u.a)(e.componentData);return S.length<2||0===c?e:Object(j.a)(Object(j.a)({},e),{},{componentData:Be(S,c,c-1)});case"recordSnapshot":var w,N=Object(j.a)({},e);return N.snapshots[++N.snapshotIndex]=null===a||void 0===a||null===(w=a.snapshots)||void 0===w?void 0:w[0],N.snapshotIndex<N.snapshots.length-1&&(N.snapshots=N.snapshots.slice(0,N.snapshotIndex+1)),N;case"setPreview":return Object(j.a)(Object(j.a)({},e),{},{preview:a});case"createEvents":var D=Object(d.a)(e.componentData),k=D[c];k.events=k.events||[];var E=Object(p.a)(k.events,["key",a.key]);return E>-1?k.events.splice(E,1,a):k.events.push(a),Object(j.a)(Object(j.a)({},e),{},{componentData:D});case"removeEvents":return Object(j.a)(Object(j.a)({},e),{},{preview:a});case"setCanvasStyle":return Object(j.a)(Object(j.a)({},e),{},{canvasStyle:Object(j.a)(Object(j.a)({},e.canvasStyle),a)});default:throw new Error}}function Ve(e,t){var n=t.type,a=t.payload;switch(n){case"show":return Object(j.a)(Object(j.a)({},e),{},{visible:!0});case"hide":return Object(j.a)(Object(j.a)({},e),{},{visible:!1});case"setPosition":return Object(j.a)(Object(j.a)({},e),{},{position:a})}}n(297);var Fe=n(320),Ge=n(310),Je=function(e){var t=e.prefixCls,n=void 0===t?"visual-drag-header":t,a=e.onReload,c=Object(r.useContext)(W),o=c.componentDispatch,i=c.componentState.componentData,s=function(e,t){return o({type:"setCanvasStyle",payload:Object(O.a)({},e,t)})};return Object(X.jsx)("header",{className:n,children:Object(X.jsxs)(Fe.b,{size:12,children:[Object(X.jsx)(R.a,{size:"small",onClick:function(){o({type:"undo"})},children:"\u64a4\u9500"}),Object(X.jsx)(R.a,{size:"small",onClick:function(){null===a||void 0===a||a(),o({type:"redo"})},children:"\u91cd\u505a"}),Object(X.jsx)(R.a,{size:"small",onClick:function(){return o({type:"setPreview",payload:!0})},children:"\u9884\u89c8"}),Object(X.jsx)(R.a,{size:"small",onClick:function(){o({type:"recordSnapshot",payload:{snapshots:[i]}})},children:"\u4fdd\u5b58"}),Object(X.jsxs)(Fe.b,{children:["\u753b\u5e03\u5927\u5c0f",Object(X.jsx)(Ge.a,{size:"small",min:1,max:1200,defaultValue:1200,onChange:function(e){return s("width",e)}}),"*",Object(X.jsx)(Ge.a,{size:"small",min:1,max:760,defaultValue:760,onChange:function(e){return s("height",e)}})]})]})})},Ke=function(e){var t=e.prefixCls,n=Object(r.useReducer)(He,{isClickComponent:!1,preview:!1,snapshotIndex:-1,curComponentId:-1,snapshots:[],dragShiftStyle:{},canvasStyle:{width:1200,height:760},componentData:[{id:0,name:"r-button",label:"\u6309\u94ae",props:{},style:{width:100,height:32,borderWidth:1,borderColor:"",borderRadius:"",fontSize:14,fontWeight:500,lineHeight:"",letterSpacing:0,textAlign:"",color:"",backgroundColor:"",rotate:0,opacity:1,top:86,left:117}}]}),a=Object(b.a)(n,2),c=a[0],o=a[1],i=Object(r.useReducer)(Ve,{visible:!1,position:{left:0,top:0}}),s=Object(b.a)(i,2),l=s[0],j=s[1],h=c.componentData,f=c.isClickComponent,O=c.curComponentId,v=c.canvasStyle,x=Object(r.useMemo)((function(){return Object(p.a)(h,["id",O])}),[h,O]);return Object(X.jsx)("div",{className:t,children:Object(X.jsx)(W.Provider,{value:{curComponentIndex:x,componentState:c,componentDispatch:o},children:Object(X.jsxs)(A.Provider,{value:{menuState:l,menuDispatch:j},children:[Object(X.jsx)(Je,{}),Object(X.jsxs)("div",{className:"".concat(t,"-content"),children:[Object(X.jsx)("div",{className:"".concat(t,"-content-left"),children:Object(X.jsx)(T,{})}),Object(X.jsx)("div",{className:"".concat(t,"-content-wrapper"),style:v,children:Object(X.jsx)("div",{className:"".concat(t,"-content-wrapper-canvas"),onDrop:function(e){e.preventDefault(),e.stopPropagation();var t=Object(d.a)(m[Number(e.dataTransfer.getData("index"))]);t.style.top=e.nativeEvent.offsetY,t.style.left=e.nativeEvent.offsetX,t.id=C(),o({type:"setComponentData",payload:[].concat(Object(u.a)(h),[t])})},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},onMouseUp:function(e){f||setTimeout((function(){o({type:"setCurComponent",payload:{id:-1}})}),0),2!==e.button&&j({type:"hide"})},onMouseDown:function(){return o({type:"setClick",payload:!1})},children:Object(X.jsx)(ye,{})})}),Object(X.jsx)("div",{className:"".concat(t,"-content-show"),children:Object(X.jsx)(Ae,{})})]})]})})})};Ke.defaultProps={prefixCls:"home"};var qe=Ke;var Qe=function(){return Object(X.jsx)("div",{className:"App",children:Object(X.jsx)(qe,{})})};l.a.render(Object(X.jsx)(i.a.StrictMode,{children:Object(X.jsx)(a.a,{locale:o.a,children:Object(X.jsx)(Qe,{})})}),document.getElementById("root"))}},[[302,1,2]]]);
//# sourceMappingURL=main.eaf25c23.chunk.js.map